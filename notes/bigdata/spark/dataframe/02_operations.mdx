# DataFrame műveletek

A DataFrame-ek manipulálására az SQL-t imitáló műveleteken keresztül van lehetőségünk.

Tekintsük az előző fejezetben is használt `dolgozo.csv` adatfájlt.

```py
from pyspark.sql import  *
from pyspark.sql.functions import *

spark = SparkSession.builder.getOrCreate()

workers = spark.read.option('header', True).option('inferschema', True).csv('dolgozo.csv')
```



## Kiválasztás

### `select(*cols)`

A `select(*cols)` metódus egy dataframe-et ad vissza, melyben a megadott nevű oszlopok szerepelnek.

```py
df.select('DNEV', 'FIZETES').show(3)
```

| DNEV  | FIZETES |
|-------|---------|
| KING  | 5000    |
| BLAKE | 2850    |
| CLARK | 2450    |

A dataframe összes oszlopa kiválasztható, ha metódus bármelyik paramétere a `*` karakterlánc.

A

### `selectExpr()`

Úgy működik mint a sima kiválasztás, de lehetőségünk van SQL kifejezések megadására, amivel kényelmesen tudunk átnevezni
és új oszlopokat is beszúrni.

```py
df.selectExpr('DNEV', '(FIZETES + JUTALEK) as KERESET').take(3)
```

Eredmény:

```py
[Row(DNEV='KING', KERESET=5000),
 Row(DNEV='BLAKE', KERESET=2850),
 Row(DNEV='CLARK', KERESET=2450)]
```

