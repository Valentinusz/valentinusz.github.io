"use strict";(self.webpackChunkvalentinusz_github_io=self.webpackChunkvalentinusz_github_io||[]).push([[6896],{2818:(e,t,s)=>{s.r(t),s.d(t,{assets:()=>i,contentTitle:()=>l,default:()=>p,frontMatter:()=>r,metadata:()=>d,toc:()=>o});var a=s(5893),n=s(1151);const r={},l="DataFrame m\u0171veletek",d={id:"bigdata/spark/dataframe/operations",title:"DataFrame m\u0171veletek",description:"A DataFrame-ek manipul\xe1l\xe1s\xe1ra az SQL-t imit\xe1l\xf3 m\u0171veleteken kereszt\xfcl van lehet\u0151s\xe9g\xfcnk.",source:"@site/notes/bigdata/spark/dataframe/02_operations.mdx",sourceDirName:"bigdata/spark/dataframe",slug:"/bigdata/spark/dataframe/operations",permalink:"/notes/bigdata/spark/dataframe/operations",draft:!1,unlisted:!1,tags:[],version:"current",lastUpdatedBy:"Boda B\xe1lint",lastUpdatedAt:1699042492,formattedLastUpdatedAt:"2023. nov. 3.",sidebarPosition:2,frontMatter:{},sidebar:"notesSidebar",previous:{title:"L\xe9trehoz\xe1s",permalink:"/notes/bigdata/spark/dataframe/creation"},next:{title:"Spark SQL",permalink:"/notes/bigdata/spark/dataframe/sql"}},i={},o=[{value:"Kiv\xe1laszt\xe1s",id:"kiv\xe1laszt\xe1s",level:2},{value:"<code>select(*cols)</code>",id:"selectcols",level:3},{value:"<code>selectExpr()</code>",id:"selectexpr",level:3}];function c(e){const t={code:"code",h1:"h1",h2:"h2",h3:"h3",p:"p",pre:"pre",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",...(0,n.a)(),...e.components};return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(t.h1,{id:"dataframe-m\u0171veletek",children:"DataFrame m\u0171veletek"}),"\n",(0,a.jsx)(t.p,{children:"A DataFrame-ek manipul\xe1l\xe1s\xe1ra az SQL-t imit\xe1l\xf3 m\u0171veleteken kereszt\xfcl van lehet\u0151s\xe9g\xfcnk."}),"\n",(0,a.jsxs)(t.p,{children:["Tekints\xfck az el\u0151z\u0151 fejezetben is haszn\xe1lt ",(0,a.jsx)(t.code,{children:"dolgozo.csv"})," adatf\xe1jlt."]}),"\n",(0,a.jsx)(t.pre,{children:(0,a.jsx)(t.code,{className:"language-py",children:"from pyspark.sql import  *\nfrom pyspark.sql.functions import *\n\nspark = SparkSession.builder.getOrCreate()\n\nworkers = spark.read.option('header', True).option('inferschema', True).csv('dolgozo.csv')\n"})}),"\n",(0,a.jsx)(t.h2,{id:"kiv\xe1laszt\xe1s",children:"Kiv\xe1laszt\xe1s"}),"\n",(0,a.jsx)(t.h3,{id:"selectcols",children:(0,a.jsx)(t.code,{children:"select(*cols)"})}),"\n",(0,a.jsxs)(t.p,{children:["A ",(0,a.jsx)(t.code,{children:"select(*cols)"})," met\xf3dus egy dataframe-et ad vissza, melyben a megadott nev\u0171 oszlopok szerepelnek."]}),"\n",(0,a.jsx)(t.pre,{children:(0,a.jsx)(t.code,{className:"language-py",children:"df.select('DNEV', 'FIZETES').show(3)\n"})}),"\n",(0,a.jsxs)(t.table,{children:[(0,a.jsx)(t.thead,{children:(0,a.jsxs)(t.tr,{children:[(0,a.jsx)(t.th,{children:"DNEV"}),(0,a.jsx)(t.th,{children:"FIZETES"})]})}),(0,a.jsxs)(t.tbody,{children:[(0,a.jsxs)(t.tr,{children:[(0,a.jsx)(t.td,{children:"KING"}),(0,a.jsx)(t.td,{children:"5000"})]}),(0,a.jsxs)(t.tr,{children:[(0,a.jsx)(t.td,{children:"BLAKE"}),(0,a.jsx)(t.td,{children:"2850"})]}),(0,a.jsxs)(t.tr,{children:[(0,a.jsx)(t.td,{children:"CLARK"}),(0,a.jsx)(t.td,{children:"2450"})]})]})]}),"\n",(0,a.jsxs)(t.p,{children:["A dataframe \xf6sszes oszlopa kiv\xe1laszthat\xf3, ha met\xf3dus b\xe1rmelyik param\xe9tere a ",(0,a.jsx)(t.code,{children:"*"})," karakterl\xe1nc."]}),"\n",(0,a.jsx)(t.p,{children:"A"}),"\n",(0,a.jsx)(t.h3,{id:"selectexpr",children:(0,a.jsx)(t.code,{children:"selectExpr()"})}),"\n",(0,a.jsx)(t.p,{children:"\xdagy m\u0171k\xf6dik mint a sima kiv\xe1laszt\xe1s, de lehet\u0151s\xe9g\xfcnk van SQL kifejez\xe9sek megad\xe1s\xe1ra, amivel k\xe9nyelmesen tudunk \xe1tnevezni\n\xe9s \xfaj oszlopokat is besz\xfarni."}),"\n",(0,a.jsx)(t.pre,{children:(0,a.jsx)(t.code,{className:"language-py",children:"df.selectExpr('DNEV', '(FIZETES + JUTALEK) as KERESET').take(3)\n"})}),"\n",(0,a.jsx)(t.p,{children:"Eredm\xe9ny:"}),"\n",(0,a.jsx)(t.pre,{children:(0,a.jsx)(t.code,{className:"language-py",children:"[Row(DNEV='KING', KERESET=5000),\n Row(DNEV='BLAKE', KERESET=2850),\n Row(DNEV='CLARK', KERESET=2450)]\n"})})]})}function p(e={}){const{wrapper:t}={...(0,n.a)(),...e.components};return t?(0,a.jsx)(t,{...e,children:(0,a.jsx)(c,{...e})}):c(e)}},1151:(e,t,s)=>{s.d(t,{Z:()=>d,a:()=>l});var a=s(7294);const n={},r=a.createContext(n);function l(e){const t=a.useContext(r);return a.useMemo((function(){return"function"==typeof e?e(t):{...t,...e}}),[t,e])}function d(e){let t;return t=e.disableParentContext?"function"==typeof e.components?e.components(n):e.components||n:l(e.components),a.createElement(r.Provider,{value:t},e.children)}}}]);